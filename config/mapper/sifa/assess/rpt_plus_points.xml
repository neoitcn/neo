<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aofa.sifa.mapper.assess.RptPlusPointsDao">
  <resultMap id="rptPlusPointsMap" type="RptPlusPoints">
    <id column="id" jdbcType="VARCHAR" property="id" />
    <result column="company_name" jdbcType="VARCHAR" property="companyName" />
    <result column="prisoner_name" jdbcType="VARCHAR" property="prisonerName" />
    <result column="prisoner_phone" jdbcType="VARCHAR" property="prisonerPhone" />
    <result column="plus_type" jdbcType="SMALLINT" property="plusType" />
    <result column="points" jdbcType="INTEGER" property="points" />
    <result column="operator" jdbcType="VARCHAR" property="operator" />
    <result column="plus_date" jdbcType="TIMESTAMP" property="plusDate" />
    <result column="plus_reason" jdbcType="VARCHAR" property="plusReason" />
    <result column="remarks" jdbcType="VARCHAR" property="remarks" />
    <result column="state" jdbcType="INTEGER" property="state" />
  </resultMap>
  <sql id="rptPlusPointsColumns">
    pp.id, pp.company_name, pp.prisoner_name, pp.prisoner_phone, pp.plus_type, pp.points, pp.operator, pp.plus_date, 
    pp.plus_reason, pp.remarks,pp.state
  </sql>
  <sql id="rptPlusPointsColumns2">
    id, company_name, prisoner_name, prisoner_phone, plus_type, points, operator, plus_date, 
    plus_reason, remarks,state
  </sql>
  <select id="getRptPlusPoints" resultMap="rptPlusPointsMap">
  	select <include refid="rptPlusPointsColumns"></include>
  	from rpt_plus_points pp
  	where 1=1
  	<if  test="prisonerName != null and prisonerName != ''">
  		and pp.prisoner_name like concat('%',#{prisonerName},'%')
  	</if>
  	<if test="plusDate != null">
  		and pp.plus_date <![CDATA[>=]]> #{plusDate}
  	</if>
  	<if test="rows > 0">
  		limit #{start},#{rows}
  	</if>
  </select>
  <select id="getCount" resultType="java.lang.Long">
  	select 
  		count(id)
  	from rpt_plus_points pp
  	where 1=1
  	<if  test="prisonerName != null and prisonerName != ''">
  		and pp.prisoner_name like concat('%',#{prisonerName},'%')
  	</if>
  	<if test="plusDate != null">
  		and pp.plus_date <![CDATA[>=]]> #{plusDate}
  	</if>
  </select>
  <select id="getRptPlusPointsById" resultMap="rptPlusPointsMap">
  	select <include refid="rptPlusPointsColumns"></include>
  	from rpt_plus_points pp
  	where pp.id=#{id}
  </select>
  <insert id="addPlusPoints">
    insert into rpt_plus_points (
    	<include refid="rptPlusPointsColumns2"></include>
    )
    values (#{id,jdbcType=VARCHAR}, #{companyName,jdbcType=VARCHAR}, #{prisonerName,jdbcType=VARCHAR}, 
      #{prisonerPhone,jdbcType=VARCHAR}, #{plusType,jdbcType=SMALLINT}, #{points,jdbcType=INTEGER}, 
      #{operator,jdbcType=VARCHAR}, #{plusDate,jdbcType=TIMESTAMP}, #{plusReason,jdbcType=VARCHAR}, 
      #{remarks,jdbcType=VARCHAR},#{state})
  </insert>
  <update id="updatePlusPoints">
    update rpt_plus_points
    set company_name = #{companyName,jdbcType=VARCHAR},
      prisoner_name = #{prisonerName,jdbcType=VARCHAR},
      prisoner_phone = #{prisonerPhone,jdbcType=VARCHAR},
      plus_type = #{plusType,jdbcType=SMALLINT},
      points = #{points,jdbcType=INTEGER},
      operator = #{operator,jdbcType=VARCHAR},
      plus_date = #{plusDate,jdbcType=TIMESTAMP},
      plus_reason = #{plusReason,jdbcType=VARCHAR},
      remarks = #{remarks,jdbcType=VARCHAR}
    where id = #{id,jdbcType=VARCHAR}
  </update>
  <update id="handlePlusPoints">
    update rpt_plus_points
    set state = 0
    where id = #{id,jdbcType=VARCHAR}
  </update>
</mapper>