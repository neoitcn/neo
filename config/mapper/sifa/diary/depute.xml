<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aofa.sifa.mapper.diary.DeputeDao">
	<sql id="deputeColumns">
		d.id,
		d.name,
		d.phone,
		d.depositor,
		d.status,
		d.description,
		d.corr_company,
		d.depo_time,
		d.remarks,
		d.creater_id,
		d.create_time,
		d.update_id,
		d.update_time,
		d.deleted
	</sql>
	<sql id="deputeColumns2">
		id,
		name,
		phone,
		depositor,
		status,
		description,
		corr_company,
		depo_time,
		remarks,
		creater_id,
		create_time,
		update_id,
		update_time,
		deleted
	</sql>
	<resultMap type="Depute" id="deputeMap" extends="baseBean">
		<id column="id" property="id"></id>
		<result column="name" property="name"/>
		<result column="phone" property="phone"/>
		<result column="depositor" property="depositor"/>
		<result column="status" property="status"/>
		<result column="description" property="description"/>
		<result column="corr_company" property="corrCompany"/>
		<result column="depo_time" property="depoTime"/>
		<result column="remarks" property="remarks"/>
	</resultMap>
	<resultMap type="BaseBean" id="baseBean">
		<result column="creater_id" property="createrId"/>
		<result column="create_time" property="createTime"/>
		<result column="update_id" property="updateId"/>
		<result column="update_time" property="updateTime"/>
		<result property="deleted" column="deleted" />
		<result property="enabled" column="enabled" />
	</resultMap>
    
    <select id="getCount" resultType="java.lang.Long">
    	select count(*) from dm_depute d where d.deleted=1
    	<if test="name != null and name!=''">
			and d.name like concat('%',#{name},'%')
		</if>
		<if test="depoTime !=null">
			and d.depo_time >= #{depoTime}
		</if>
    </select>
    
    <select id="getDeputes" resultMap="deputeMap">
    	select 
			<include refid="deputeColumns" />
		from dm_depute d where d.deleted=1
		<if test="name != null and name!=''">
			and d.name like concat('%',#{name},'%')
		</if>
		<if test="depoTime !=null">
			and d.depo_time >= #{depoTime}
		</if>
		<if test="rows > 0">
			limit #{start},#{rows}
		</if>
    </select>
    <select id="getDeputeById" resultMap="deputeMap">
    	select 
			<include refid="deputeColumns" />
		from dm_depute d where d.deleted=1 and d.id=#{id}
	</select>
	<insert id="addDepute">
		insert into dm_depute(
			<include refid="deputeColumns2" />
		)values(
			#{id},
			#{name},
			#{phone},
			#{depositor},
			#{status},
			#{description},
			#{corrCompany},
			#{depoTime},
			#{remarks},
			#{createrId},
			#{createTime},
			#{updateId},
			#{updateTime},
			#{deleted}
		)
	</insert>
    <update id="updateDepute">
		update dm_depute set
			name=#{name},
			corr_company=#{corrCompany},
			remarks=#{remarks},
			phone=#{phone},
			depositor=#{depositor},
			description=#{description},
			status=#{status},
			depo_time=#{depoTime},
			update_id=#{updateId},
			update_time=#{updateTime},
			deleted=#{deleted}
		where id=#{id}
	</update>
	<update id="deleteDepute">
		update dm_depute set deleted=0 where id=#{id}
	</update>
</mapper>